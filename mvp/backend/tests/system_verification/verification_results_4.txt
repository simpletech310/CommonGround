============================= test session starts ==============================
platform darwin -- Python 3.10.9, pytest-9.0.2, pluggy-1.6.0 -- /Users/tj/Desktop/CommonGround/mvp/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/tj/Desktop/CommonGround
plugins: anyio-4.12.0, asyncio-1.3.0, langsmith-0.5.1, cov-7.0.0
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 13 items

mvp/backend/tests/system_verification/test_auth_verification.py::test_auth_flow FAILED [  7%]
mvp/backend/tests/system_verification/test_health_checks.py::TestDatabaseHealth::test_database_connection PASSED [ 15%]
mvp/backend/tests/system_verification/test_health_checks.py::TestDatabaseHealth::test_database_tables_exist PASSED [ 23%]
mvp/backend/tests/system_verification/test_health_checks.py::TestRedisHealth::test_redis_connection PASSED [ 30%]
mvp/backend/tests/system_verification/test_health_checks.py::TestRedisHealth::test_redis_performance PASSED [ 38%]
mvp/backend/tests/system_verification/test_health_checks.py::TestExternalAPIs::test_supabase_connectivity PASSED [ 46%]
mvp/backend/tests/system_verification/test_health_checks.py::TestExternalAPIs::test_anthropic_api_connectivity PASSED [ 53%]
mvp/backend/tests/system_verification/test_health_checks.py::TestExternalAPIs::test_openai_api_connectivity PASSED [ 61%]
mvp/backend/tests/system_verification/test_health_checks.py::TestApplicationHealth::test_application_startup PASSED [ 69%]
mvp/backend/tests/system_verification/test_health_checks.py::TestApplicationHealth::test_health_endpoint PASSED [ 76%]
mvp/backend/tests/system_verification/test_health_checks.py::TestApplicationHealth::test_openapi_docs_accessible PASSED [ 84%]
mvp/backend/tests/system_verification/test_health_checks.py::TestPerformance::test_database_query_performance PASSED [ 92%]
mvp/backend/tests/system_verification/test_health_checks.py::TestPerformance::test_concurrent_requests PASSED [100%]

=================================== FAILURES ===================================
________________________________ test_auth_flow ________________________________

test_client = <httpx.AsyncClient object at 0x7f7f56163820>

    @pytest.mark.asyncio
    async def test_auth_flow(test_client: AsyncClient):
        """
        Verify complete Authentication flow: Register -> Login -> Me -> Refresh -> Logout
        """
        # 1. Register
        register_data = {
            "email": "qa_verify_auth@example.com",
            "password": "TestPassword123!",
            "first_name": "QA",
            "last_name": "Verify",
            "phone": "+15550000000"
        }
    
        # Clean up if exists (optional, or rely on test db isolation)
        # The test db isolation in conftest should handle this empty state.
    
        response = await test_client.post("/auth/register", json=register_data)
        # It might fail if user exists, but test db is fresh.
>       assert response.status_code == 201, f"Register failed: {response.text}"
E       AssertionError: Register failed: {"detail":"Not Found"}
E       assert 404 == 201
E        +  where 404 = <Response [404 Not Found]>.status_code

mvp/backend/tests/system_verification/test_auth_verification.py:25: AssertionError
=============================== warnings summary ===============================
mvp/backend/app/schemas/auth.py:78
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/auth.py:78: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class UserResponse(BaseModel):

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:72
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:72: DeprecationWarning: 'enablePackrat' deprecated - use 'enable_packrat'
    ParserElement.enablePackrat()

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:85
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:85: DeprecationWarning: 'escChar' argument is deprecated, use 'esc_char'
    quoted_identifier = QuotedString('"', escChar="\\", unquoteResults=True)

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:85
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/expressions/parser.py:85: DeprecationWarning: 'unquoteResults' argument is deprecated, use 'unquote_results'
    quoted_identifier = QuotedString('"', escChar="\\", unquoteResults=True)

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:366
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:366: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def construct_refs(cls, data: TableMetadataV1) -> TableMetadataV1:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:495
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:495: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_schemas(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:499
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:499: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_partition_specs(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:503
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:503: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_sort_orders(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:507
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:507: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def construct_refs(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:539
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:539: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_schemas(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:543
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:543: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_partition_specs(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:547
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:547: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def check_sort_orders(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:551
  /Users/tj/Desktop/CommonGround/mvp/backend/venv/lib/python3.10/site-packages/pyiceberg/table/metadata.py:551: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    def construct_refs(cls, table_metadata: TableMetadata) -> TableMetadata:

mvp/backend/app/schemas/user.py:7
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/user.py:7: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class UserProfileResponse(BaseModel):

mvp/backend/app/schemas/case.py:15
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/case.py:15: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    children: list[dict] = Field(..., min_items=1, max_items=20)

mvp/backend/app/schemas/case.py:15
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/case.py:15: PydanticDeprecatedSince20: `max_items` is deprecated and will be removed, use `max_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    children: list[dict] = Field(..., min_items=1, max_items=20)

mvp/backend/app/schemas/case.py:77
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/case.py:77: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class CaseResponse(BaseModel):

mvp/backend/app/schemas/agreement.py:25
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/agreement.py:25: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class AgreementResponse(BaseModel):

mvp/backend/app/schemas/agreement.py:44
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/agreement.py:44: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class AgreementSectionResponse(BaseModel):

mvp/backend/app/schemas/message.py:108
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/message.py:108: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class MessageFlagResponse(BaseModel):

mvp/backend/app/schemas/message.py:125
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/message.py:125: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class MessageResponse(BaseModel):

mvp/backend/app/schemas/message.py:157
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/message.py:157: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    participants: List[str] = Field(..., min_items=2, max_items=10)

mvp/backend/app/schemas/message.py:157
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/message.py:157: PydanticDeprecatedSince20: `max_items` is deprecated and will be removed, use `max_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    participants: List[str] = Field(..., min_items=2, max_items=10)

mvp/backend/app/schemas/message.py:184
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/message.py:184: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ThreadResponse(BaseModel):

mvp/backend/app/api/v1/endpoints/messages.py:42
  /Users/tj/Desktop/CommonGround/mvp/backend/app/api/v1/endpoints/messages.py:42: FastAPIDeprecationWarning: `regex` has been deprecated, please use `pattern` instead
    ai_provider: str = Query(default="claude", regex="^(claude|openai|regex)$"),

mvp/backend/app/schemas/schedule.py:41
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/schedule.py:41: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ScheduleEventResponse(BaseModel):

mvp/backend/app/schemas/schedule.py:83
  /Users/tj/Desktop/CommonGround/mvp/backend/app/schemas/schedule.py:83: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ExchangeCheckInResponse(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED mvp/backend/tests/system_verification/test_auth_verification.py::test_auth_flow
================== 1 failed, 12 passed, 27 warnings in 4.74s ===================
